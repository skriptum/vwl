---
eval: false
---
# IV Regressions

$$
y_{ct} = \beta D_{ct} + \sum_{j=1}^p \gamma_j y_{ct-j} + \alpha_c + \delta_t + \epsilon_{ct}
$$

with D as IV:

$$
D_{ct} = \sum_{j=1}^p \pi_j Z_{ct-j}+ \sum_{j=1}^p \phi y_{ct-j} + \Phi_c+ \mu_t+ v_{ct}
$$

-   Z = average of democracy in Region times initial regime cell = `demreg` in dataframe
-   D = democracy variable = `dem` variable
-   y = log gdp per capita = `y` variable

Estimated with 2SLS Regression

**Replication**

```{r}
library(tidyverse)
library(plm)
```

```{r}
DDCGdata <- haven::read_dta("data/DDCGdata.dta")

pdf <- pdata.frame(DDCGdata, index=c("country_name", "year"))
rm(DDCGdata)

head(pdf)
```

Use PLM and IVReg type formula for estimation, because IVReg does not work with panel data!

Model 1 = 1 Lag of the Instrument
```{r}
iv_model_1 <- plm(
    y ~ dem + plm::lag(y, 1:4) | 
    plm::lag(demreg,1) + plm::lag(y, 1:4),
    data=pdf,
    effect = "twoways",
    )

summary(iv_model_1)
```
Model 2 = 4 Lags of the Instrument
```{r}
iv_model_2 <- plm(
    y ~ dem + plm::lag(y, 1:4) | 
    plm::lag(demreg,1:4) + plm::lag(y, 1:4),
    data=pdf,
    effect = "twoways",
    )

summary(iv_model_2)
```

Model 3 = Dummies for Soviet Countries
```{r}
iv_model_3 <- plm(
    y ~ dem + plm::lag(y, 1:4) + sov1 + sov2 + sov3 +sov4| 
    plm::lag(demreg,1:4) + plm::lag(y, 1:4) + sov1 + sov2 + sov3 +sov4,
    data=pdf,
    effect = "twoways",
    )

summary(iv_model_3)
```

```{r}
iv_model_4 <- plm(
    y ~ dem + plm::lag(y, 1:4) + rtrend2:rtrend7 | 
    plm::lag(demreg,1:4) + plm::lag(y, 1:4) + rtrend2:rtrend7,
    data=pdf,
    effect = "twoways",
    model = "within"
    )

summary(iv_model_4)
```

## Table

```{r}
library(stargazer)
stargazer(iv_model_1, iv_model_2, iv_model_3, iv_model_4, 
          type = "text")